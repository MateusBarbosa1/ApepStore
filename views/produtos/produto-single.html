<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camisa Preta Lisa - APEP STORE</title>
    <link rel="stylesheet" href="../css/produto-single.css">
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

    <!-- Bootstrap CSS -->
    <link
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Bootstrap JS (Popper.js included) -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"
    />
    <link rel="stylesheet" href="../css/style.css" />
</head>
<body>
    <header>
      <div class="top-header">
        <div class="icon-mobile" style="padding-bottom: 3px">
          <span class="material-symbols-outlined"> menu </span>
        </div>
        <div class="logo">
          <img src="../images/logo.png" alt="" />
        </div>
        <div class="icon-mobile">
          <span class="material-symbols-outlined" style="font-size: 27px">
            shopping_cart
          </span>
        </div>
        <div class="search">
          <input
            type="search"
            name="search"
            placeholder="O que você procura hoje?"
          />
        </div>

        <nav class="options">
          <div class="login-option">
            <span class="material-symbols-outlined"> person </span>
            <% if(nome) { %>
              <a href="/account">Olá, <%= nome %></a>
            <% }  else { %>
              <a href="/login">Entrar</a>
            <% } %>
          </div>
          <div class="carrinho-option">
            <span class="material-symbols-outlined"> shopping_cart </span>
          </div>
        </nav>
      </div>
      <div class="menu">
        <span class="material-symbols-outlined close"> close </span>
        <a href="/">INICIO</a>
        <a href="/camisetas">CAMISETAS</a>
        <a href="">ROUPAS FEMININAS</a>
        <a href="">SAPATOS</a>
        <a href="">CONTATO</a>
        <a href="">SOBRE NÓS</a>
        <div class="login-option">
          <span class="material-symbols-outlined"> person </span>
          <% if(nome) { %>
            <a href="/account">Olá, <%= nome %></a>
          <% }  else { %>
            <a href="/login">Entrar</a>
          <% } %>
        </div>
      </div>
      <div class="search-mobile">
        <input
          type="search"
          name="search"
          placeholder="O que você procura hoje?"
        />
      </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <div class="product-container">
                <!-- Left Column - Product Image -->
                <div class="product-image-section">
                    <div class="product-image">
                        <img src="../images/produtos/<%= produto[0].img %>" alt="Camisa Preta Lisa">
                    </div>

                </div>

                <!-- Right Column - Product Details -->
                <div class="product-details-section">
                    <!-- Product Header -->
                    <div class="product-header">
                        <h1 class="product-title"><%= produto[0].nome_produto %></h1>

                        <!-- Rating -->
                        <div class="rating">
                            <div class="stars">
                                <span class="star filled">★</span>
                                <span class="star filled">★</span>
                                <span class="star filled">★</span>
                                <span class="star filled">★</span>
                                <span class="star half">★</span>
                            </div>
                            <span class="rating-text">4.5 (avaliações)</span>
                        </div>

                        <!-- Price -->
                        <div class="price-section">
                            <div class="price-row">
                                <%
                                    const preco = Number(produto[0].preco);
                                    const precoOriginal = preco + preco / 5;
                                %>

                                <span class="current-price">R$ <%= preco.toFixed(2) %></span>
                                <span class="original-price">R$ <%= precoOriginal.toFixed(2) %></span>
                                <span class="discount-badge">20% OFF</span>
                            </div>
                            <p class="installment-info">3x de R$ <%= (produto[0].preco / 3).toFixed(2) %> sem juros!</p>
                        </div>
                    </div>

                    <!-- Color Selection -->
                    <div class="form-group">
                        <label class="form-label">Cor</label>
                        <div class="color-options">
                            <button class="color-btn active" data-color="<%= produto[0].cores[0].hex %>" style="background-color: <%= produto[0].cores[0].hex %>;" title="<%= produto[0].cores[0].nome %>"></button>
                            <% for(let i = 1;i < produto[0].cores.length;i++) { %>
                                <button class="color-btn" data-color="<%= produto[0].cores[i].hex %>" style="background-color: <%= produto[0].cores[i].hex %>;" title="<%= produto[0].cores[i].nome %>"></button>
                            <% } %>
                        </div>
                    </div>

                    <!-- Size Selection -->
                    <div class="form-group">
                        <label class="form-label">Tamanho</label>
                        <div class="size-options">
                            <button class="size-btn">P</button>
                            <button class="size-btn active">M</button>
                            <button class="size-btn">G</button>
                            <button class="size-btn">GG</button>
                        </div>
                    </div>

                    <!-- Shipping Calculator -->
                    <div class="shipping-calculator">
                        <label class="form-label">Calcular Frete</label>
                        <div class="shipping-input-group">
                            <input type="text" id="zipCode" placeholder="Digite seu CEP" maxlength="8" class="shipping-input">
                            <button class="shipping-btn" onclick="calculateShipping()">Calcular</button>
                        </div>
                        <div id="shippingResult" class="shipping-result" style="display: none;">
                            <p>Frete para CEP <span id="zipDisplay"></span>:</p>
                            <p class="shipping-cost">R$ <span id="shippingCost">0.00</span></p>
                        </div>
                    </div>

                    <!-- Quantity Selection -->
                    <div class="form-group">
                        <label class="form-label">Quantidade</label>
                        <div class="quantity-group">
                            <div class="quantity-control">
                                <button class="qty-btn" onclick="decreaseQuantity()">−</button>
                                <input type="number" id="quantity" value="1" min="1" class="qty-input" readonly>
                                <button class="qty-btn" onclick="increaseQuantity()">+</button>
                            </div>
                            <span class="stock-info">Em estoque</span>
                        </div>
                    </div>

                    <!-- Price Summary -->
                    <div id="priceSummary" class="price-summary" style="display: none;">
                        <div class="summary-row">
                            <span>Subtotal:</span>
                            <span id="subtotal">R$ <%= produto[0].preco %></span>
                        </div>
                        <div class="summary-row">
                            <span>Frete:</span>
                            <span id="shippingFee">R$ 0.00</span>
                        </div>
                        <div class="summary-row total">
                            <span>Total:</span>
                            <span id="totalPrice">R$ <%= produto[0].preco %></span>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="action-buttons">
                        <button class="btn btn-secondary">Adicionar ao Carrinho</button>
                        <button class="btn btn-primary">Comprar Agora</button>

                    </div>

                    <!-- Buy Now Button -->

                    <!-- Description -->
                    <div class="product-description">
                        <h3>Descrição</h3>
                        <p><%= produto[0].descricao %></p>
                        <div class="description-details">
                            <div class="detail-item">
                                <strong>Material</strong>
                                <p>100% Algodão Premium</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>


    <script>
        // ===========================
// VARIÁVEIS GLOBAIS
// ===========================

const PRODUCT_PRICE = 69.90;
let selectedSize = 'M';
let selectedColor = 'black';
let quantity = 1;
let shippingCost = 0;

// ===========================
// INICIALIZAÇÃO
// ===========================

document.addEventListener('DOMContentLoaded', function() {
    initializeColorButtons();
    initializeSizeButtons();
    initializeQuantityInput();
});

// ===========================
// CORES
// ===========================

function initializeColorButtons() {
    const colorButtons = document.querySelectorAll('.color-btn');
    colorButtons.forEach(btn => {
        btn.addEventListener('click', function() {
            colorButtons.forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            selectedColor = this.dataset.color;
        });
    });
}

// ===========================
// TAMANHOS
// ===========================

function initializeSizeButtons() {
    const sizeButtons = document.querySelectorAll('.size-btn');
    sizeButtons.forEach(btn => {
        btn.addEventListener('click', function() {
            sizeButtons.forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            selectedSize = this.textContent;
        });
    });
}

// ===========================
// QUANTIDADE
// ===========================

function initializeQuantityInput() {
    const quantityInput = document.getElementById('quantity');
    quantityInput.addEventListener('change', function() {
        if (this.value < 1) this.value = 1;
        quantity = parseInt(this.value);
        updatePriceSummary();
    });
}

function increaseQuantity() {
    quantity++;
    document.getElementById('quantity').value = quantity;
    updatePriceSummary();
}

function decreaseQuantity() {
    if (quantity > 1) {
        quantity--;
        document.getElementById('quantity').value = quantity;
        updatePriceSummary();
    }
}

// ===========================
// CÁLCULO DE FRETE
// ===========================

function calculateShipping() {
    const zipCode = document.getElementById('zipCode').value;
    
    // Validar CEP
    if (zipCode.length < 5) {
        alert('Digite um CEP válido!');
        return;
    }

    // Simular cálculo de frete
    // Fórmula: R$ 10 + R$ 2 por dígito do CEP
    shippingCost = 10 + (zipCode.length * 2);

    // Exibir resultado
    document.getElementById('zipDisplay').textContent = zipCode;
    document.getElementById('shippingCost').textContent = shippingCost.toFixed(2);
    document.getElementById('shippingResult').style.display = 'block';

    // Atualizar resumo de preço
    updatePriceSummary();
}

// ===========================
// RESUMO DE PREÇO
// ===========================

function updatePriceSummary() {
    const subtotal = PRODUCT_PRICE * quantity;
    const total = subtotal + shippingCost;

    document.getElementById('subtotal').textContent = `R$ ${subtotal.toFixed(2)}`;
    document.getElementById('shippingFee').textContent = `R$ ${shippingCost.toFixed(2)}`;
    document.getElementById('totalPrice').textContent = `R$ ${total.toFixed(2)}`;

    // Mostrar resumo apenas se houver frete calculado
    if (shippingCost > 0) {
        document.getElementById('priceSummary').style.display = 'block';
    }
}

// ===========================
// FAVORITOS
// ===========================

function toggleWishlist(button) {
    button.classList.toggle('active');
    
    if (button.classList.contains('active')) {
        button.innerHTML = '<span class="heart">❤</span> Favoritar';
        showNotification('Adicionado aos favoritos!');
    } else {
        button.innerHTML = '<span class="heart">♡</span> Favoritar';
        showNotification('Removido dos favoritos!');
    }
}

// ===========================
// NOTIFICAÇÕES
// ===========================

function showNotification(message) {
    // Criar elemento de notificação
    const notification = document.createElement('div');
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background-color: #10b981;
        color: white;
        padding: 1rem 1.5rem;
        border-radius: 0.5rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        z-index: 1000;
        animation: slideIn 0.3s ease;
    `;
    notification.textContent = message;

    // Adicionar animação
    const style = document.createElement('style');
    style.textContent = `
        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }
    `;
    document.head.appendChild(style);

    document.body.appendChild(notification);

    // Remover após 3 segundos
    setTimeout(() => {
        notification.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => {
            notification.remove();
        }, 300);
    }, 3000);
}

// ===========================
// ADICIONAR AO CARRINHO
// ===========================

document.addEventListener('DOMContentLoaded', function() {
    const addToCartBtn = document.querySelector('.btn-secondary');
    if (addToCartBtn) {
        addToCartBtn.addEventListener('click', function() {
            const cartItem = {
                name: 'Camisa Preta Lisa',
                size: selectedSize,
                color: selectedColor,
                quantity: quantity,
                price: PRODUCT_PRICE,
                total: PRODUCT_PRICE * quantity
            };

            // Salvar no localStorage
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            cart.push(cartItem);
            localStorage.setItem('cart', JSON.stringify(cart));

            showNotification(`${quantity} item(ns) adicionado(s) ao carrinho!`);
        });
    }

    // Botão Comprar Agora
    const buyNowBtn = document.querySelector('.btn-primary');
    if (buyNowBtn) {
        buyNowBtn.addEventListener('click', function() {
            if (shippingCost === 0) {
                alert('Por favor, calcule o frete antes de comprar!');
                return;
            }

            const orderSummary = `
                Produto: Camisa Preta Lisa
                Tamanho: ${selectedSize}
                Cor: ${selectedColor}
                Quantidade: ${quantity}
                Preço Unitário: R$ ${PRODUCT_PRICE.toFixed(2)}
                Subtotal: R$ ${(PRODUCT_PRICE * quantity).toFixed(2)}
                Frete: R$ ${shippingCost.toFixed(2)}
                Total: R$ ${((PRODUCT_PRICE * quantity) + shippingCost).toFixed(2)}
            `;

            alert('Resumo do Pedido:\n\n' + orderSummary + '\n\nRedirecionando para pagamento...');
            // Aqui você integraria com um sistema de pagamento real
        });
    }
});
    </script>
</body>
</html>