<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camisa Preta Lisa - APEP STORE</title>
    <link rel="stylesheet" href="../css/produto-single.css">
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

    <!-- Bootstrap CSS -->
    <link
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Bootstrap JS (Popper.js included) -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"
    />
    <link rel="stylesheet" href="../css/style.css" />
</head>
<body>
    <header>
      <div class="top-header">
        <div class="icon-mobile" style="padding-bottom: 3px">
          <span class="material-symbols-outlined"> menu </span>
        </div>
        <div class="logo">
          <img src="../images/logo.png" alt="" onclick="window.location.href = '/';" />
        </div>
        <div class="icon-mobile">
          <span class="material-symbols-outlined" style="font-size: 27px" onclick="window.location.href = '/carrinho'">
            shopping_cart
          </span>
        </div>
        <div class="search">
          <input
            type="search"
            name="search"
            placeholder="O que você procura hoje?"
          />
        </div>

        <nav class="options">
          <div class="login-option">
            <span class="material-symbols-outlined"> person </span>
            <% if(nome) { %>
              <a href="/account">Olá, <%= nome %></a>
            <% }  else { %>
              <a href="/login">Entrar</a>
            <% } %>
          </div>
          <div class="carrinho-option">
            <span class="material-symbols-outlined" onclick="window.location.href = '/carrinho'"> shopping_cart </span>
          </div>
        </nav>
      </div>
      <div class="menu">
        <span class="material-symbols-outlined close"> close </span>
        <a href="/">INICIO</a>
        <a href="/all-roupas">TODAS AS ROUPAS</a>
        <a href="/camisetas">CAMISETAS</a>
        <a href="/roupas-femininas">ROUPAS FEMININAS</a>
        <a href="/sapatos">SAPATOS</a>
        <a href="/sobre">SOBRE NÓS</a>
        <div class="login-option">
          <span class="material-symbols-outlined"> person </span>
          <% if(nome) { %>
            <a href="/account">Olá, <%= nome %></a>
          <% }  else { %>
            <a href="/login">Entrar</a>
          <% } %>
        </div>
      </div>
      <div class="search-mobile">
        <input
          type="search"
          name="search"
          placeholder="O que você procura hoje?"
        />
      </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <div class="product-container">
                <!-- Left Column - Product Image -->
                <div class="product-image-section">
                    <div class="product-image">
                        <img src="../images/produtos/<%= produto[0].img %>" alt="Camisa Preta Lisa">
                    </div>

                </div>

                <!-- Right Column - Product Details -->
                <div class="product-details-section">
                    <!-- Product Header -->
                    <div class="product-header">
                        <h1 class="product-title"><%= produto[0].nome_produto %></h1>

                        <!-- Rating -->
                        <div class="rating">
                            <div class="stars">
                                <span class="star filled">★</span>
                                <span class="star filled">★</span>
                                <span class="star filled">★</span>
                                <span class="star filled">★</span>
                                <span class="star half">★</span>
                            </div>
                            <span class="rating-text">4.5 (avaliações)</span>
                        </div>

                        <!-- Price -->
                        <div class="price-section">
                            <div class="price-row">
                                <%
                                    const preco = Number(produto[0].preco);
                                    const precoOriginal = preco + preco / 5;
                                %>

                                <span class="current-price">R$ <%= preco.toFixed(2) %></span>
                                <span class="original-price">R$ <%= precoOriginal.toFixed(2) %></span>
                                <span class="discount-badge">20% OFF</span>
                            </div>
                            <p class="installment-info">3x de R$ <%= (produto[0].preco / 3).toFixed(2) %> sem juros!</p>
                        </div>
                    </div>

                    <!-- Color Selection -->
                    <div class="form-group">
                        <label class="form-label">Cor</label>
                        <div class="color-options">
                            <button class="color-btn active" data-color="<%= produto[0].cores[0].nome %>" style="background-color: <%= produto[0].cores[0].hex %>;" title="<%= produto[0].cores[0].nome %>"></button>
                            <% for(let i = 1;i < produto[0].cores.length;i++) { %>
                                <button class="color-btn" data-color="<%= produto[0].cores[i].nome %>" style="background-color: <%= produto[0].cores[i].hex %>;" title="<%= produto[0].cores[i].nome %>"></button>
                            <% } %>
                        </div>
                    </div>

                    <!-- Size Selection -->
                    <div class="form-group">
                        <label class="form-label">Tamanho</label>
                        <div class="size-options">
                            <button class="size-btn active"><%= produto[0].tamanhos[0] %></button>
                            <% for(let l = 1;l < produto[0].tamanhos.length;l++) { %>
                              <button class="size-btn"><%= produto[0].tamanhos[l] %></button>
                            <% } %>
                        </div>
                    </div>

                    <!-- Shipping Calculator -->
                    <div class="shipping-calculator">
                        <label class="form-label">Calcular Frete</label>
                        <div class="shipping-input-group">
                            <input type="text" id="zipCode" placeholder="Digite seu CEP" maxlength="8" class="shipping-input">
                            <button class="shipping-btn" onclick="calculateShipping()">Calcular</button>
                        </div>
                        <div id="shippingResult" class="shipping-result" style="display: none;">
                            <p>Frete para CEP <span id="zipDisplay"></span>:</p>
                            <p class="shipping-cost">R$ <span id="shippingCost">0.00</span></p>
                        </div>
                    </div>

                    <!-- Quantity Selection -->
                    <div class="form-group">
                        <label class="form-label">Quantidade</label>
                        <div class="quantity-group">
                            <div class="quantity-control">
                                <button class="qty-btn" onclick="decreaseQuantity()">−</button>
                                <input type="number" id="quantity" value="1" min="1" class="qty-input" readonly>
                                <button class="qty-btn" onclick="increaseQuantity()">+</button>
                            </div>
                            <span class="stock-info">Em estoque</span>
                        </div>
                    </div>

                    <!-- Price Summary -->
                    <div id="priceSummary" class="price-summary" style="display: none;">
                        <div class="summary-row">
                            <span>Subtotal:</span>
                            <span id="subtotal">R$ <%= produto[0].preco %></span>
                        </div>
                        <div class="summary-row">
                            <span>Frete:</span>
                            <span id="shippingFee">R$ 0.00</span>
                        </div>
                        <div class="summary-row total">
                            <span>Total:</span>
                            <span id="totalPrice">R$ <%= produto[0].preco %></span>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="action-buttons">
                        <% if(nome) { %>
                          <button class="btn btn-secondary btn-cart" data-id="<%= produto[0].id_produto %>">Adicionar ao Carrinho</button>
                          <button class="btn btn-primary btn-comprar">Comprar Agora</button>
                        <% } else { %>
                          <button class="btn btn-secondary" onclick="window.location.href='/carrinho'">Adicionar ao Carrinho</button>
                          <button class="btn btn-primary btn-comprar">Comprar Agora</button>
                        <% } %>
                    </div>

                    <!-- Buy Now Button -->

                    <!-- Description -->
                    <div class="product-description">
                        <h3>Descrição</h3>
                        <p><%= produto[0].descricao %></p>
                        <div class="description-details">
                            <div class="detail-item">
                                <strong>Material</strong>
                                <p>100% <%= produto[0].material %></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>


    <script src="../js/produto.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../js/mobile-menu.js"></script>
</body>
</html>